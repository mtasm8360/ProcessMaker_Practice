{"name":"01_گرید","description":"","items":[{"type":"form","variable":"","var_uid":"","dataType":"","id":"9299237376650bbb36c5cc9095523021","name":"01_گرید","description":"","mode":"edit","script":{"type":"js","code":""},"language":"en","externalLibs":"","printable":false,"items":[[{"type":"form","variable":"","var_uid":"","dataType":"","id":"6243371426672dee88e4a98039816308","name":"03_grid_t1","description":"","mode":"edit","script":{"type":"js","code":"var txtScore = $('#txt_score_total');\nvar grid = $('#grd_task1');\ntxtScore.setText(0);\n\n// while grid checnged find out the SUM value and the score total will be set \ngrid.on('change', function () {\n     var result = 0;\n     var SumVal;\n     var rows = grid.getNumberRows();\n     for (var row = 1; row <= rows; row++) {\n          result += +$(\"#grd_task1\").getValue(row, 4);\n     }\n     txtScore.setText(result);\n\n     for (var row = 1; row <= rows; row++) {\n          SumVal = 0;\n          SumVal = +$(\"#grd_task1\").getValue(row, 4) * +$(\"#grd_task1\").getValue(row, 5);\n          $(\"#grd_task1\").setValue(SumVal, row, 6);\n     }\n})\n"},"language":"en","externalLibs":"","printable":false,"items":[[{"type":"grid","variable":"grd_task1","var_uid":"3693577706650bc556b34a8078069556","dataType":"grid","protectedValue":false,"id":"grd_task1","name":"grd_task1","label":"","hint":"","required":false,"requiredFieldErrorMessage":"","columns":[{"type":"text","variable":"","var_uid":"","dataType":"","protectedValue":false,"id":"txt_name","name":"txt_name","label":"Name","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"parent","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"columnWidth":"20","width":100,"title":"Name","var_name":"grd_task1"},{"type":"text","variable":"","var_uid":"","dataType":"","protectedValue":false,"id":"txt_addrss","name":"txt_addrss","label":"Address","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"parent","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"columnWidth":"20","width":100,"title":"Address"},{"type":"text","variable":"","var_uid":"","dataType":"","protectedValue":false,"id":"txt_doc","name":"txt_doc","label":"Doc","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"parent","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"columnWidth":"10","width":100,"title":"Doc"},{"type":"text","variable":"","var_uid":"","dataType":"","protectedValue":false,"id":"txt_score","name":"txt_score","label":"Score","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"parent","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"columnWidth":"10","width":100,"title":"Score"},{"type":"text","variable":"","var_uid":"","dataType":"","protectedValue":false,"id":"txt_rate","name":"txt_rate","label":"Rate","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"parent","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"columnWidth":"10","width":100,"title":"Rate"},{"type":"text","variable":"","var_uid":"","dataType":"","protectedValue":false,"id":"txt_sum","name":"txt_sum","label":"Sum","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"parent","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"columnWidth":"20","width":100,"title":"Sum"}],"data":[],"mode":"parent","layout":"responsive","pageSize":"0","addRow":true,"deleteRow":true,"title":"","colSpan":12}],[{"type":"label","id":"label0000000001","label":"Score total : ","ariaLabel":"","colSpan":2},{"type":"text","variable":"txt_score_total","var_uid":"94028009466519e31389d40022796604","dataType":"string","protectedValue":false,"id":"txt_score_total","name":"txt_score_total","label":"","tabIndex":"","defaultValue":"","placeholder":"","hint":"","ariaLabel":"","required":false,"requiredFieldErrorMessage":"","textTransform":"none","validate":"","validateMessage":"","maxLength":1000,"formula":"","mode":"disabled","operation":"","dbConnection":"workflow","dbConnectionLabel":"PM Database","sql":"","memoryCache":false,"var_name":"txt_score_total","colSpan":2},{"colSpan":2},{"colSpan":2},{"colSpan":2},{"colSpan":2}]],"variables":[{"var_uid":"3693577706650bc556b34a8078069556","prj_uid":"6249974966650bb5f454b80074674973","var_name":"grd_task1","var_field_type":"grid","var_field_size":10,"var_label":"grid","var_dbconnection":"workflow","var_dbconnection_label":"PM Database","var_sql":"","var_null":0,"var_default":"","var_accepted_values":[],"inp_doc_uid":"","var_uid_old":"3693577706650bc556b34a8078069556","var_name_old":"grd_task1","prj_uid_old":"6249974966650bb5f454b80074674973","create":false},{"var_uid":"94028009466519e31389d40022796604","prj_uid":"6249974966650bb5f454b80074674973","var_name":"txt_score_total","var_field_type":"string","var_field_size":10,"var_label":"string","var_dbconnection":"workflow","var_dbconnection_label":"PM Database","var_sql":"","var_null":0,"var_default":"","var_accepted_values":[],"inp_doc_uid":"","var_uid_old":"94028009466519e31389d40022796604","var_name_old":"txt_score_total","prj_uid_old":"6249974966650bb5f454b80074674973","create":false}],"colSpan":12}],[{"type":"form","variable":"","var_uid":"","dataType":"","id":"7205037686672df6a86a3d6039840241","name":"05_js_subform","description":"","mode":"edit","script":{"type":"js","code":"var txtScore = $('#txt_score_total');\nvar grid = $('#grd_task1');\nvar table = $('#myDataTable');\n\n// Do these codes if it's the task2 dynaform \nif ($('#5065342436672def120b088097302840')) {\n     // set sum of scores and set it to unique control \n     txtScore.setText(0);\n     grid.on('change', function () {\n          var result = 0;\n          var SumVal;\n          var rows = grid.getNumberRows();\n          for (var row = 1; row <= rows; row++) {\n               result += +grid.getValue(row, 4);\n          }\n          txtScore.setText(result);\n          for (var row = 1; row <= rows; row++) {\n               SumVal = 0;\n               SumVal = +grid.getValue(row, 4) * +grid.getValue(row, 5);\n               grid.setValue(SumVal, row, 6);\n          }\n     })\n\n     // two tabs and changing them \n     $('#button0000000001').on('click', function () {\n          // open the grid section\n          grid.show();\n          $('#label0000000001').show();\n          $('#txt_score_total').show();\n          $('#button0000000003').show();\n          table.hide();\n          // table.destroy();\n          $('#subtitle0000000001').hide()\n\n     })\n\n     $('#button0000000002').on('click', function () {\n          // open the data table section  \n          table.show();\n          // createTheDataTable();\n          $('#subtitle0000000001').show();\n          grid.hide();\n          $('#label0000000001').hide();\n          $('#txt_score_total').hide();\n          $('#button0000000003').hide();\n     })\n\n     // when add to table button clicked \n     $('#button0000000003').on('click', function () {\n          var rows = grid.getNumberRows();\n          for (var row = 1; row <= rows; row++) {\n               // Get values of grid \n               var name = grid.getValue(row, 1);\n               var adrs = grid.getValue(row, 2);\n               var doc = grid.getValue(row, 3);\n               var score = grid.getValue(row, 4);\n               var rate = grid.getValue(row, 5);\n               var sum = grid.getValue(row, 6);\n\n               // Fill the table with values \n               var tbody = document.getElementById('myDataTable').getElementsByTagName('tbody')[0];\n               var newRow = document.createElement('tr');\n               var cells = [name, adrs, doc, score, rate, sum];\n               var counter = 0;\n               cells.forEach((item) => {\n                    if (item == 0)\n                         counter++;\n               })\n               if (counter >= 6){\n                    counter = 0;\n                    continue;\n               }\n               for (var i = 0; i < cells.length; i++) {\n                    var newCell = document.createElement('td');\n                    newCell.textContent = cells[i];\n                    newRow.appendChild(newCell);\n               }\n               tbody.appendChild(newRow);\n\n          }\n     })\n}\n\n\n\n\nif ($('#6243371426672dee88e4a98039816308')) {\n     var txtScore = $('#txt_score_total');\n     txtScore.setText(0);\n\n     // If grid checnged find out the SUM value and the score total will be set \n     grid.on('change', function () {\n          var result = 0;\n          var SumVal;\n          var rows = grid.getNumberRows();\n          for (var row = 1; row <= rows; row++) {\n               result += +grid.getValue(row, 4);\n          }\n          txtScore.setText(result);\n\n          for (var row = 1; row <= rows; row++) {\n               SumVal = 0;\n               SumVal = +grid.getValue(row, 4) * +grid.getValue(row, 5);\n               grid.setValue(SumVal, row, 6);\n          }\n     })\n}\n\n\n// Function to load CSS\nvar loadCSS = function (url) {\n     var link = document.createElement(\"link\");\n     link.rel = \"stylesheet\";\n     link.href = url;\n     document.getElementsByTagName(\"head\")[0].appendChild(link);\n};\n\nloadCSS(\"https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css\");\n\nvar loadScript = function (url, callback) {\n     var script = document.createElement(\"script\");\n     script.type = \"text/javascript\";\n     if (script.readyState) {\n          script.onreadystatechange = function () {\n               if (script.readyState === \"loaded\" || script.readyState === \"complete\") {\n                    script.onreadystatechange = null;\n                    callback();\n               }\n          };\n     } else {\n          script.onload = function () {\n               callback();\n          };\n     }\n     script.src = url;\n     document.getElementsByTagName(\"head\")[0].appendChild(script);\n};\n\nfunction createTheDataTable() {\n     // Code for task 2 and for loading kendo table and filling data to it from table \n     loadScript(\"https://code.jquery.com/jquery-3.5.1.min.js\", function () {\n          loadScript(\"https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js\", async function () {\n\n               // Function to fetch data from PMT_GRID\n               async function fetchData() {\n                    // AJAX code to GET all data from PMT_GRID table for kendo-table \n                    await $.ajax({\n                         url: window.location,\n                         type: 'POST',\n                         dataType: \"json\",\n                         data: {\n                              act: \"GET_KENDO_DATA\",\n                         },\n                         success: function (data) {\n                              // Clear the table body before populating\n                              var tableBody = $('#myDataTable tbody');\n                              tableBody.empty();\n                              // Fill the table with data\n                              for (key in data) {\n                                   var rowHtml = `\n                                             <tr>\n                                                  <td>${data[key].NAME}</td>\n                                                  <td>${data[key].ADDRESS}</td>\n                                                  <td>${data[key].DOC}</td>\n                                                  <td>${data[key].SCORE}</td>\n                                                  <td>${data[key].RATE}</td>\n                                                  <td>${data[key].SUM}</td>\n                                             </tr>\n                                             `;\n                                   tableBody.append(rowHtml);\n                              }\n                              // Initialize DataTables after data is loaded\n                              $('#myDataTable').DataTable();\n                         },\n                         error: function (err) {\n                              console.log(\"oh an Error  :\", err)\n                         }\n                    })\n               }\n\n               // Insert table after the specified element\n               $('#subtitle0000000001').after(`\n             <table id=\"myDataTable\" class=\"display\" style=\"width:100%\">\n                 <thead>\n                     <tr>\n                         <th>NAME</th>\n                         <th>ADDRESS</th>\n                         <th>DOC</th>\n                         <th>SCORE</th>\n                         <th>RATE</th>\n                         <th>SUM</th>\n                     </tr>\n                 </thead>\n                 <tbody>\n                 </tbody>\n             </table>\n         `);\n\n               // Fetch data and populate the table\n               await fetchData();\n          });\n     });\n}\n\ncreateTheDataTable();"},"language":"en","externalLibs":"//cdn.datatables.net/2.0.8/js/dataTables.min.js\n\n\n","printable":false,"items":[],"variables":[],"colSpan":12}],[{"type":"submit","id":"submit0000000001","name":"submit0000000001","label":"ثبت","tabIndex":"","ariaLabel":"","colSpan":12}]],"variables":[]}]}